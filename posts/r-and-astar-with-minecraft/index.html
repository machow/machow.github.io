<!DOCTYPE html>
<html lang="en-us">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta content="keyword 1, keyword 2, keyword 3" name="keywords">
<meta content="Michael Chow" name="author">
<meta property="og:title" content="Using R and the A* Algorithm: Cruising Around Minecraft - Michael Chow">
<meta property="og:url" content="/posts/r-and-astar-with-minecraft/">
<meta property="og:description" content="Your description here">
<meta property="og:type" content="website" />
<title>Using R and the A* Algorithm: Cruising Around Minecraft | Michael Chow</title>

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>
<link rel="stylesheet" href="/css/style.css">
<link rel="shortcut icon" href="/wave.ico">
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/styles/github.min.css">

</head>

<body>
<section class="section">
  <div class="container">
    <nav class="nav">
      <div class="nav-left">
        <a class="nav-item" href="/"><h1 class="title is-4">Michael Chow</h1></a>
      </div>
      <div class="nav-right">
        <nav class="nav-item level is-mobile">
          
          <a class="level-item" href="https://github.com/machow" target="_blank">
            <span class="icon">
              <i class="fa fa-github"></i>
            </span>
          </a>
          
          <a class="level-item" href="https://twitter.com/chowthedog" target="_blank">
            <span class="icon">
              <i class="fa fa-twitter"></i>
            </span>
          </a>
          
          <a class="level-item" href="https://linkedin.com/in/michael-a-chow/" target="_blank">
            <span class="icon">
              <i class="fa fa-linkedin-square"></i>
            </span>
          </a>
          
        </nav>
      </div>
    </nav>
  </div>
</section>

<section class="section">
  <div class="container">
    <h1 class="title">Using R and the A* Algorithm: Cruising Around Minecraft</h1>
    <h2 class="subtitle is-5">September 28, 2018 by Michael Chow</h2>
    
    <div class="content">
      <p>In case you haven’t heard, there are a bunch of cool ways you can interact with minecraft from R.
These include making a nice drawing of your mug, plotting a ggplot graph, and building mazes.</p>
<p>Recently at the NYC R conference, I had the chance to see David Smith demo building a maze, and then navigate it using the left-hand rule.
It was really cool!
By the end of the talk, as we stepped out of the maze and my gaze turned to the lofty minecraft peaks in the distance, a gentle thought stirred.</p>
<p><img src="/004-astar-minecraft-craggyslope.png" /></p>
<p>I knew then that my heart belonged to finding the optimal path up one of those craggy slopes.</p>
<p>In this post, I’ll quickly go through an R package I put together for using the A* algorithm, and how to apply it to minecraft.</p>
<p>Navigating minecraft involves two pieces:</p>
<ol style="list-style-type: decimal">
<li>Coding A* to navigate a 3D space</li>
<li>Using the <code>miner</code> library to interact with minecraft</li>
</ol>
<div id="cruising-around-minecraft" class="section level2">
<h2>Cruising Around Minecraft</h2>
<video style = "width: 100%" controls>
<source src="https://s3.amazonaws.com/mchow/posts/004-astar-craggyslope.mp4">
</video>
</div>
<div id="setting-up-a" class="section level2">
<h2>Setting up A*</h2>
<pre class="r"><code>library(astar)

M &lt;- matrix(ncol = 4, byrow = TRUE, c(
  0,0,1,0,
  0,0,1,0,
  1,0,1,0,
  0,0,0,0)
  )

MOVES &lt;- list(c(-1, 0), c(0, 1), c(1, 0), c(0, -1))</code></pre>
<p>(IMAGES OF MAZE, NAVIGATION OPTIONS)</p>
<pre class="r"><code>hash_func &lt;- function(node) paste(node, collapse = &#39;-&#39;)

neighbors &lt;- function(node) {
  # calculate moves from current node position
  candidates &lt;- lapply(MOVES, function(x) x + node)
  # remove any that go outside the matrix
  Filter(function(ind) all(ind &gt; 0) &amp; all(ind &lt;= dim(M)), candidates)
}</code></pre>
<p>Explain</p>
<ul>
<li>each node is c(x, y), so we need to convert to a string</li>
<li>we need to check that our coords are valid in neighbors</li>
</ul>
<pre class="r"><code>is_goal_reached &lt;- function(src, dst) identical(src, dst)

edge_distance &lt;- function(src, dst) {
  # infinite cost for hitting a wall (marked with ones)
  value = M[dst[1], dst[2]]
  if (value == 1) Inf else sum(abs(src - dst))
}

cost_estimate &lt;- function(node, goal) sum(abs(node - goal))

run &lt;- function() astar::astar(c(1,1), c(1,4),
                               cost_estimate, edge_distance,
                               neighbors, is_goal_reached, hash_func)</code></pre>
<p>Explain</p>
<ul>
<li></li>
</ul>
</div>
<div id="slinging-blocks-in-minecraft-with-the-miner-library" class="section level2">
<h2>Slinging Blocks in Minecraft with the miner Library</h2>
<p>Explain</p>
<ul>
<li>setBlock expects M[ii,jj] -&gt; setBlock(jj, height, ii, M[ii,jj])</li>
</ul>
<pre class="r"><code>library(miner)
mc_connect()

# Make a nice frame around maze in minecraft
setBlocks(0, 0, 0, nrow(M) + 1, 0, ncol(M) + 1, 2)
setBlocks(1, 0, 1, nrow(M), 0, ncol(M), 0)

# Lay out maze
for (ii in 1:nrow(M)) {
  for (jj in 1:ncol(M)) {
    # middle arg is height, last arg is block id
    # 0 is air, 1 is stone
    setBlock(jj, 0, ii, M[ii,jj])
  }
}

# Show path through maze
path &lt;- run()
for (xy in path) {
  # set path to be a red wool block
  setBlock(xy[2], 0, xy[1], 35, 14)
}</code></pre>
<p><img src="/004-astar-minecraft-maze.png" /></p>
<p>And there you have it.</p>
<p>Visit</p>
<ul>
<li><a href="https://github.com/machow/astar-r">machow/astar-r</a></li>
<li>miner: <a href="https://github.com/ropenscilabs/miner" class="uri">https://github.com/ropenscilabs/miner</a></li>
</ul>
<!--
<video style="width: 50%" controls>
  <source src="https://s3.amazonaws.com/mchow/posts/004-astar-minecraft-3dmaze.mp4">
</video>
-->
</div>

    </div>
    
  </div>
</section>


<section class="section">
  <div class="container has-text-centered">
    <p>&copy; 2017 | Follow on <a href="https://twitter.com/chowthedog" target="_blank">Twitter</a> | <a href="https://github.com/mgjohansen/hucore.git" target="_blank">Hucore theme</a> & <a href="http://gohugo.io" target="_blank">Hugo</a> ♥</p>
  </div>
</section>


<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.11.0/highlight.min.js" integrity="sha256-+bhVTaRmJ/c07eV80nU8gD2cBBF0rYkf1txqXlrbvb0=" crossorigin="anonymous"></script>

<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.11.0/languages/go.min.js"></script>
<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js"></script>

<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.11.0/languages/dockerfile.min.js"></script>
<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js"></script>

<script>hljs.initHighlightingOnLoad();</script>


<script>
window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
ga('create', 'UA-117743385-1', 'auto');
ga('send', 'pageview');
</script>
<script async src='//www.google-analytics.com/analytics.js'></script>



</body>
